# TEM-CWDAM-Sensitivity-FNN

Parameter sensitivity analysis and rapid neural network prediction of transient electromagnetic (TEM) responses in core-wall dams.

---

## Overview

This repository provides MATLAB code for:

* **Permutation-based sensitivity analysis** (both grouped and pairwise interaction) of geometric and electrical boundary parameters in earth-rock (core-wall) dams.
* **Time-varying and multi-scale visualization** of sensitivity results.
* **Feedforward neural network (FNN) modeling** for fast and accurate prediction of TEM response curves under various dam boundary conditions.
* All scripts are fully documented and support reproduction and further research.

---

## Features

* Sensitivity analysis for both geometric (dam height, slope ratio, core wall slope, water level) and electrical (dam body, foundation, core wall, upstream water resistivity) parameters.
* Visualization of parameter main effects and pairwise interaction effects over multiple time intervals.
* FNN-based rapid prediction: reduces forward modeling time from hours to seconds with relative error <0.6%.
* Example data structure and easy customization for your own datasets.

---

## Repository Structure

| File Name                                    | Description                                                   |
| -------------------------------------------- | ------------------------------------------------------------- |
| `permutation_sensitivity_grouped.  m`          | Grouped, time-varying permutation sensitivity analysis        |
| `plot_permutation_sensitivity_timevarying.  m` | Visualization of time-varying sensitivity with error bands    |
| `pairwise_permutation_sensitivity.  m`         | Pairwise interaction sensitivity analysis and heatmap results |
| `plot_pairwise_permutation_heatmap.  m`        | High-quality plotting of pairwise sensitivity heatmaps        |
| `tem_fnn_prediction.  m`                       | Feedforward neural network for rapid TEM curve prediction     |
| `normalized_data.  mat`                        | Example data structure (required for running scripts)         |
| `permutation_grouped_sensitivity.  mat`        | Saved grouped permutation sensitivity results                 |
| `AB_pairwise_triangle_heatmap_timeseg5.  mat`  | Pairwise sensitivity results (for visualization)              |
| `trained_net.  mat`                            | Example trained neural network (generated by script)          |
| `LICENSE`                                    | (Optional) License (MIT recommended for academic sharing)     |

---

## Requirements

* MATLAB R2019a or newer
* Statistics and Machine Learning Toolbox
* Neural Network Toolbox

---

## Quick Start

1.   **Clone or download** this repository, and add it to your MATLAB path.
2.   Ensure the file `normalized_data.  mat` is present in the working directory.
3.   Run `permutation_sensitivity_grouped.  m` to perform grouped sensitivity analysis.
4.   Run `plot_permutation_sensitivity_timevarying.  m` to visualize main effect sensitivity.
5.   Run `pairwise_permutation_sensitivity.  m` and `plot_pairwise_permutation_heatmap.  m` for pairwise interaction analysis.
6.   Run `tem_fnn_prediction.  m` to train and test the neural network, or predict new response curves.

---

## Data

* The provided `normalized_data.  mat` is a sample structure containing normalized input parameters and log(Bz) response curves.
* For your own research or industrial applications, replace this with your data in the same structure.

---

## Citation



## Contact

For questions, suggestions, or collaborations:

* **Zhang Shenghang** (Author)
* National Key Laboratory of Water Disaster Prevention, NHRI, Nanjing, China
* Email: [sxzhang@nhri.cn]

* **Lei Tang** (Corresponding Author)
* National Key Laboratory of Water Disaster Prevention, NHRI, Nanjing, China
* Email: [ltang@nhri.cn]


---

**Welcome to contribute, open issues, or fork this project for further research!  **

---

> *Last updated: 2024-08-19*
